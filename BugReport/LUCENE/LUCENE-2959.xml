<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:24:19 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2959/LUCENE-2959.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2959] [GSoC] Implementing State of the Art Ranking for Lucene</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2959</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Lucene employs the Vector Space Model (VSM) to rank documents, which compares&lt;br/&gt;
unfavorably to state of the art algorithms, such as BM25. Moreover, the architecture is&lt;br/&gt;
tailored specically to VSM, which makes the addition of new ranking functions a non-&lt;br/&gt;
trivial task.&lt;/p&gt;

&lt;p&gt;This project aims to bring state of the art ranking methods to Lucene and to implement a&lt;br/&gt;
query architecture with pluggable ranking functions.&lt;/p&gt;

&lt;p&gt;The wiki page for the project can be found at &lt;a href=&quot;http://wiki.apache.org/lucene-java/SummerOfCode2011ProjectRanking&quot; class=&quot;external-link&quot;&gt;http://wiki.apache.org/lucene-java/SummerOfCode2011ProjectRanking&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12501006">LUCENE-2959</key>
            <summary>[GSoC] Implementing State of the Art Ranking for Lucene</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="david_nemeskey">David Mark Nemeskey</reporter>
                        <labels>
                        <label>gsoc2011</label>
                        <label>lucene-gsoc-11</label>
                        <label>mentor</label>
                    </labels>
                <created>Thu, 10 Mar 2011 10:49:34 +0000</created>
                <updated>Fri, 10 May 2013 11:44:13 +0100</updated>
                    <resolved>Sun, 11 Sep 2011 16:49:51 +0100</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                <fixVersion>flexscoring branch</fixVersion>
                                <component>core/query/scoring</component>
                <component>general/javadocs</component>
                <component>modules/examples</component>
                        <due></due>
                    <votes>1</votes>
                        <watches>5</watches>
                                                    <aggregatetimeoriginalestimate seconds="1234800">343h</aggregatetimeoriginalestimate>
                        <aggregatetimeremainingestimate seconds="1234800">343h</aggregatetimeremainingestimate>
                                      <comments>
                    <comment id="13005345" author="ab" created="Thu, 10 Mar 2011 21:41:25 +0000"  >&lt;p&gt;You are probably familiar with this paper and the code... just in case I&apos;m adding a reference here: &lt;a href=&quot;http://arxiv.org/abs/0911.5046&quot; class=&quot;external-link&quot;&gt;http://arxiv.org/abs/0911.5046&lt;/a&gt;&lt;/p&gt;</comment>
                    <comment id="13005575" author="david_nemeskey" created="Fri, 11 Mar 2011 10:08:53 +0000"  >&lt;p&gt;Andrzej: thanks! Indeed, I have read that that paper, but have only skimmed through the code. I am also aware of at least one BM25 implementation for Lucene, which may or may not be what issue &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2091&quot; title=&quot;Add BM25 Scoring to Lucene&quot;&gt;&lt;del&gt;LUCENE-2091&lt;/del&gt;&lt;/a&gt; is about. I need to have a look into it.&lt;/p&gt;</comment>
                    <comment id="13005577" author="david_nemeskey" created="Fri, 11 Mar 2011 10:15:17 +0000"  >&lt;p&gt;Added a link to the issue mentioned in my last comment (and yet another one). The relation between them is not exactly clear for me yet, should consult with Robert first.&lt;/p&gt;</comment>
                    <comment id="13012996" author="rcmuir" created="Wed, 30 Mar 2011 15:53:47 +0100"  >&lt;p&gt;Hi David, to try to help get things moving, I created a branch: &lt;a href=&quot;https://svn.apache.org/repos/asf/lucene/dev/branches/flexscoring&quot; class=&quot;external-link&quot;&gt;https://svn.apache.org/repos/asf/lucene/dev/branches/flexscoring&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This is the in-progress work from &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2392&quot; title=&quot;Enable flexible scoring&quot;&gt;&lt;del&gt;LUCENE-2392&lt;/del&gt;&lt;/a&gt;, which separates the scoring calculates from the postings-list matching. In short, Similarity becomes very low-level, but the idea is that you extend it to present a higher-level API (for example TFIDFSimilarity: &lt;a href=&quot;http://svn.apache.org/repos/asf/lucene/dev/branches/flexscoring/lucene/src/java/org/apache/lucene/search/TFIDFSimilarity.java&quot; class=&quot;external-link&quot;&gt;http://svn.apache.org/repos/asf/lucene/dev/branches/flexscoring/lucene/src/java/org/apache/lucene/search/TFIDFSimilarity.java&lt;/a&gt;) that is user-friendly and allows users to adjust parameters in a way that makes sense to that scoring system.&lt;/p&gt;

&lt;p&gt;As a start I implemented some very very rough/basic models in src/test:&lt;br/&gt;
BM25: &lt;a href=&quot;http://svn.apache.org/repos/asf/lucene/dev/branches/flexscoring/lucene/src/test/org/apache/lucene/search/MockBM25Similarity.java&quot; class=&quot;external-link&quot;&gt;http://svn.apache.org/repos/asf/lucene/dev/branches/flexscoring/lucene/src/test/org/apache/lucene/search/MockBM25Similarity.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Dirichlet LM: &lt;a href=&quot;http://svn.apache.org/repos/asf/lucene/dev/branches/flexscoring/lucene/src/test/org/apache/lucene/search/MockLMSimilarity.java&quot; class=&quot;external-link&quot;&gt;http://svn.apache.org/repos/asf/lucene/dev/branches/flexscoring/lucene/src/test/org/apache/lucene/search/MockLMSimilarity.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But these are in no way correct or extensible or nice. For example, the BM25 similarity is slow, because as implemented its &quot;average document length&quot; is &quot;live&quot; (e.g. if you add more segments its immediately adjusted for each query)... there is no caching at all. &lt;/p&gt;

&lt;p&gt;For example in this case, to speed up BM25, it could be nice for the Similarity to pull this up-front, and create cached calculations. If a user wants to refresh their bm25 stats then they could do something in SimilarityProvider to call it to recalculate the caches.&lt;/p&gt;

&lt;p&gt;However, for a user that wants &quot;super-realtime&quot; view, it might be better for it to stay the way it is now, or alternatively for the Sim to up-front do the 256 calculations per query (ideally in weight, not per-segment in docscorer) to tableize the length normalizations.&lt;/p&gt;

&lt;p&gt;So these are the API challenges we need to consider if we want to provide actual implementations of these scoring systems: how to make them perform close to or as fast as lucene&apos;s current scoring model.&lt;/p&gt;

&lt;p&gt;Separately on the issue, I want to make Weight completely opaque to the sim, really its just a way for a Similarity to compute things up front (such as IDF, but maybe things like these bm25 length norm caches too). Currently it can only have a single float value (see my un-sqrt&apos;ing and other hacks in the Mock sims), so this should be fixed.&lt;/p&gt;

&lt;p&gt;Additionally another big TODO: just as Scorer was split (maybe we should rename it to Matcher now that sim does the calcs?), the process of Explanations need to be split too, where a Sim is completely responsible for explaining itself.&lt;/p&gt;

&lt;p&gt;Another TODO i have is to write the norm summation into the norms file as a single vlong, rather than computing it across all byte[] in segmentreader like I do now... I just implemented it this way so that we could play with scoring algorithms easily.&lt;/p&gt;

&lt;p&gt;So, the good news would be that scoring is a lot more flexible, but the &quot;bad&quot; news is that in order to support lucene&apos;s features, implementing a new ranking system on top of Similarity is really &lt;b&gt;serious&lt;/b&gt; work, as you need to:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;implement the lower-level API efficiently, yet expose a nice high-level API such as TFIDFSimilarity&apos;s tf() and idf() hooks for users.&lt;/li&gt;
	&lt;li&gt;implement explanations so that users can debug relevance issues.&lt;/li&gt;
	&lt;li&gt;think about allowing users to balance the various performance tradeoffs, such as balancing the performance gained by caching things versus using realtime statistics (some of this could be in my head, maybe computing 256 norm decoder caches up-front is really cheap and a non-issue).&lt;/li&gt;
	&lt;li&gt;consider how to integrate lucene&apos;s features into the ranking system, for example how to estimate a reasonable &quot;phrase IDF&quot; for phrase/multiphrase/span queries, how to integrate index-time boosts (in my example BM25 etc, I just made the documents appear shorter to accomplish this), depending upon how the length normalization is being stored in the index, how to pick the best quantization (might not be SmallFloat352), etc etc.&lt;/li&gt;
	&lt;li&gt;do all the relevance testing to ensure that things are correct (i found lots of bugs doing rough testing on my Mock ones, there are probably more!, but on the couple test collections i tried they seemed reasonable)&lt;/li&gt;
	&lt;li&gt;adding good quality documentation such as what we have today in TFIDFSimilarity that explains how the ranking system works and how you can tune it.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                    <comment id="13013015" author="rcmuir" created="Wed, 30 Mar 2011 16:24:29 +0100"  >&lt;p&gt;David, for your perusal here is another sim i tried to write: DFR I(F)L2&lt;/p&gt;

&lt;p&gt;its probably got bugs, but demonstrates again the challenges here.&lt;/p&gt;

&lt;p&gt;If we want to support ranking systems like this, how can they be made fast?&lt;/p&gt;

&lt;p&gt;The one i wrote has no score caching, so it does a lot of per-document divisions, multiplications, etc and this is no good.&lt;/p&gt;

&lt;p&gt;So its gonna be hard to make these have competitive performance with lucene&apos;s current scoring, which for TF &amp;lt; 32 is an array lookup and a single multiplication.&lt;/p&gt;

&lt;p&gt;Its more obvious to me how to eek good performance from the language modelling formula because you can re-arrange the log and boil it down to some addition, but we need to get creative thinking about how to make some of these other models fast, and its more complicated if you want to make say a dfr &quot;framework&quot; that allows you to pick basic model and the 2 normalizations, versus specializing the code for each possibility (and there are many).&lt;/p&gt;

&lt;p&gt;My advice to you for GSOC would be to just pick one of these (e.g. BM25) and figure out how to do it really well, good performance, good api and documentation, and good relevance testing to ensure its quality.&lt;/p&gt;

&lt;p&gt;I&apos;m more than happy to help with the boring parts like refactoring lucene&apos;s Explanations API &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="13013907" author="david_nemeskey" created="Thu, 31 Mar 2011 11:22:35 +0100"  >&lt;p&gt;Robert: thanks for all the info! It&apos;s nice to see so much work has already been done. I plan to delve into it after the selection, and try to get other things out of the way until then, so that I can concentrate on GSoC during the summer.&lt;/p&gt;

&lt;p&gt;I think the main point would be to make the addition of a new ranking function as easy as possible. At least a prototype implementation should be very straightforward, even at the expense of performance. Then, if the new method provides good results, the developer can go on to the lower level to squeeze more juice out of it. It&apos;s hard for me to discuss new this without knowing the code, of course, but do you think it is possible?&lt;/p&gt;

&lt;p&gt;Even though I added a &quot;Performance&quot; section to my proposal (&lt;a href=&quot;http://www.google-melange.com/gsoc/proposal/review/google/gsoc2011/davidnemeskey/1&quot; class=&quot;external-link&quot;&gt;http://www.google-melange.com/gsoc/proposal/review/google/gsoc2011/davidnemeskey/1&lt;/a&gt;), I see now that it&apos;s probably more important than I believed it to be at first. I think I will follow your advice and concentrate on how to make BM25F fast. It may be a bit tougher nut to crack than DFR, as the latter has logarithms scattered all over it. However, the first thing that comes to mind is that the tf-BM25 curve becomes almost flat very quickly (less so for a high k1 value, though). So it may be possible to pre-compute a tf map or array for a query.&lt;/p&gt;</comment>
                    <comment id="13013944" author="rcmuir" created="Thu, 31 Mar 2011 13:22:08 +0100"  >&lt;blockquote&gt;
&lt;p&gt;I think the main point would be to make the addition of a new ranking function as easy as possible. At least a prototype implementation should be very straightforward, even at the expense of performance. Then, if the new method provides good results, the developer can go on to the lower level to squeeze more juice out of it. It&apos;s hard for me to discuss new this without knowing the code, of course, but do you think it is possible?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This sounds great! For example, you could extend the low-level api, gather every possible statistic that lucene has, and present a high-level api that looks more like terrier&apos;s scoring api (which i&apos;m guessing is what researchers would prefer?), where they basically implement the scoring in one method with all the stats there.&lt;/p&gt;

&lt;p&gt;So someone would extend this API to do prototyping, it would make it easier to experiment.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;I think I will follow your advice and concentrate on how to make BM25F fast.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Actually as far as BM25f, this one presents a few challenges (some already discussed on &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2091&quot; title=&quot;Add BM25 Scoring to Lucene&quot;&gt;&lt;del&gt;LUCENE-2091&lt;/del&gt;&lt;/a&gt;). &lt;/p&gt;

&lt;p&gt;To summarize:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;for any field, Lucene has a per-field terms dictionary that contains that term&apos;s docFreq. To compute BM25f&apos;s IDF method would be challenging, because it wants a docFreq &quot;across all the fields&quot;. (its not clear to me at a glance either from the original paper, if this should be across only the fields in the query, across all the fields in the document, and if a &quot;static&quot; schema is implied in this scoring system (in lucene document 1 can have 3 fields and document 2 can have 40 different ones, even with different properties).&lt;/li&gt;
	&lt;li&gt;the same issue applies to length normalization, lucene has a &quot;field length&quot; but really no concept of document length.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So I just wanted to mention that while its possible here to apply a per-field TF boost before the non-linear TF saturation, its not immediately clear how to adjust the BM25f formula to lucene: how to combine these scores without using a (wasteful) &quot;catch-all-field&quot; and some lying behind the scenes to force this catch-all-field&apos;s length normalization and docFreq to be used.&lt;/p&gt;

&lt;p&gt;Too many questions arise for BM25f and how it would &quot;fit&quot; with lucene, for example the fact that &quot;multiple fields&quot; can really mean anything, and having a field in lucene doesnt mean at all that it was in your original document! For example, Solr users frequently use a &quot;copyField&quot; to take the content of one field, duplicate it to a different field (and perhaps apply some processing). In terms of things like length normalization, it seems that &quot;document length&quot; calculated as the sum across the fields would be wrong for many use cases.&lt;/p&gt;

&lt;p&gt;I only wanted to recommend against this one because of this rather serious challenge, it seems its something we might want to table at the moment: lucene is changing fast and as new capabilities arise, we might realize there is a more elegant way to address this... but at the moment I think I would recommend starting with BM25.&lt;/p&gt;

</comment>
                    <comment id="13014472" author="david_nemeskey" created="Fri, 1 Apr 2011 09:45:10 +0100"  >&lt;p&gt;Robert,&lt;/p&gt;

&lt;p&gt;As for the problems with BM25F&lt;/p&gt;

&lt;blockquote&gt;
&lt;ul&gt;
	&lt;li&gt;for any field, Lucene has a per-field terms dictionary that contains that term&apos;s docFreq. To compute BM25f&apos;s IDF method would be challenging, because it wants a docFreq &quot;across all the fields&quot;.&lt;/li&gt;
	&lt;li&gt;the same issue applies to length normalization, lucene has a &quot;field length&quot; but really no concept of document length.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;One thing that is not clear for me is why these limitations would not be a problem for BM25. As I see it, the difference between the two methods is that BM25 simply computes tfs, idfs and document length from the whole document &amp;#8211; which, according to what you said, is not available Lucene. That&apos;s why I figured that a variant of BM25F would actually be more straightforward to implement.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;(its not clear to me at a glance either from the original paper, if this should be across only the fields in the query, across all the fields in the document, and if a &quot;static&quot; schema is implied in this scoring system (in lucene document 1 can have 3 fields and document 2 can have 40 different ones, even with different properties).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Actually I am not sure there is a consensus on what BM25F actually is. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; For example, the BM25 formula can be applied to the weighted sum of field tfs, or alternatively, the per-field BM25 scores can be summarized as well after normalization. I&apos;ve seen both called (maybe incorrectly) BM25F.&lt;/p&gt;

&lt;p&gt;If I understand correctly, the current scoring algorithm takes into account only the fields explicitly specified in the query. Is that right? If so, I see no reason why BM25 should behave otherwise. Which of course also means that we probably won&apos;t be able to save the summarized doc length and idf.&lt;/p&gt;

&lt;p&gt;Robert, would you be so kind to have a look at my proposal? It can be found at &lt;a href=&quot;http://www.google-melange.com/gsoc/proposal/review/google/gsoc2011/davidnemeskey/1&quot; class=&quot;external-link&quot;&gt;http://www.google-melange.com/gsoc/proposal/review/google/gsoc2011/davidnemeskey/1&lt;/a&gt;. It&apos;s basically the same as what I sent to the mailing list. I wrote that I want to implement BM25, BM25F and DFR (&quot;the framework&quot;, I meant with one or two smoothing models), as well as to convert the original scoring to the new framework. In light of the thread here, I guess it would be better to modify these goals, perhaps by:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;deleting the conversion part?&lt;/li&gt;
	&lt;li&gt;committing myself to BM25/BM25F only?&lt;/li&gt;
	&lt;li&gt;explicitly stating that I want a higher level API based on the low-level one?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;As for the last item, it is only if I continue / join the work in 2392. Since I guess nobody wants two ranking frameworks, of course I will, but then in this part of the proposal should I just concentrate on the higher level API?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                    <comment id="13014547" author="rcmuir" created="Fri, 1 Apr 2011 14:16:15 +0100"  >&lt;blockquote&gt;
&lt;p&gt;One thing that is not clear for me is why these limitations would not be a problem for BM25. As I see it, the difference between the two methods is that BM25 simply computes tfs, idfs and document length from the whole document &#8211; which, according to what you said, is not available Lucene. That&apos;s why I figured that a variant of BM25F would actually be more straightforward to implement.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;A variant sounds really interesting? I think you know better than me here, I just looked at the original paper and thought to myself that to implement this &quot;by the book&quot; might not be feasible for a while.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Robert, would you be so kind to have a look at my proposal? It can be found at &lt;a href=&quot;http://www.google-melange.com/gsoc/proposal/review/google/gsoc2011/davidnemeskey/1&quot; class=&quot;external-link&quot;&gt;http://www.google-melange.com/gsoc/proposal/review/google/gsoc2011/davidnemeskey/1&lt;/a&gt;. It&apos;s basically the same as what I sent to the mailing list. I wrote that I want to implement BM25, BM25F and DFR (&quot;the framework&quot;, I meant with one or two smoothing models), as well as to convert the original scoring to the new framework. In light of the thread here, I guess it would be better to modify these goals, perhaps by:&lt;/p&gt;

&lt;p&gt;deleting the conversion part?&lt;br/&gt;
committing myself to BM25/BM25F only?&lt;br/&gt;
explicitly stating that I want a higher level API based on the low-level one?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think you can decide what you want to do? Obviously I would love to see all of it done &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;But its your choice, I could see you going a couple different ways:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;closer to your original proposal, you could still develop a flexible scoring API on top of Similarity. Hey, all I did was move stuff from Scorer to Similarity really, which does give flexibility, but its probably not what an IR researcher would want (its low-level and confusing). So you could make a &quot;SimpleSimilarity&quot; or &quot;EasySimilarity&quot; or something thats presents a much simpler API (something closer to what terrier/indri present) on top of this, for easily implementing ranking functions? I think this would be extremely valuable long-term: who cares if we have a low-level flexible scoring API that only speed demons like, but IR practitioners find confusing and hideous? Someone who is trying to experiment with an enhancement to relevance likely doesn&apos;t care if their TREC run takes 30 seconds instead of 20 seconds if the API is really easy and they aren&apos;t wasting time fighting with lucene? If you go this route, you could implement BM25, DFR, etc as you suggested as examples to how to use this API, and there would be more of a focus on API quality and simplicity instead of performance.&lt;/li&gt;
	&lt;li&gt;or alternatively, you could refine your proposal to implement a really &quot;production strength&quot; version of one of these scoring systems on top of the low-level API, that would ideally have competitive performance/documentation/etc with Lucene&apos;s default scoring today. If you decide to do this, then yes, I would definitely suggest picking only one, because I think its a ton of work as I listed above, and I think there would be more focus on practical things (some probably being nuances of lucene) and performance.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="13014619" author="david_nemeskey" created="Fri, 1 Apr 2011 15:35:51 +0100"  >&lt;blockquote&gt;
&lt;p&gt;I think you can decide what you want to do?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Fair enough. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I guess I&apos;ll stick with my original proposal then, though I might change a few things here and there; maybe change the focus from flexibility (as it seems to be already underway) to simplicity.&lt;/p&gt;</comment>
                    <comment id="13016617" author="rcmuir" created="Thu, 7 Apr 2011 00:50:56 +0100"  >&lt;p&gt;setting myself as assignee as i&apos;d like to mentor this one.&lt;/p&gt;</comment>
                    <comment id="13016741" author="david_nemeskey" created="Thu, 7 Apr 2011 08:36:13 +0100"  >&lt;p&gt;Thanks Robert, that would be terrific.&lt;/p&gt;</comment>
                    <comment id="13089449" author="david_nemeskey" created="Tue, 23 Aug 2011 14:28:25 +0100"  >&lt;p&gt;Robert: maybe we could resolve this issue as well? Once we decide what to do with 3173 &amp;#8211; perhaps a won&apos;tfix?&lt;/p&gt;</comment>
                    <comment id="13089453" author="rcmuir" created="Tue, 23 Aug 2011 14:30:25 +0100"  >&lt;p&gt;I think we can defer that one or just leave it open for consideration later.&lt;/p&gt;

&lt;p&gt;As far as this issue, lets keep it open until we merge branch to trunk!&lt;/p&gt;</comment>
                    <comment id="13090685" author="rcmuir" created="Thu, 25 Aug 2011 02:54:34 +0100"  >&lt;p&gt;I rearranged the BM25 in the branch a little bit, its now as fast as lucene&apos;s ranking formula:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;                Task   QPS tfidf StdDev tfidf   QPS bm25 StdDev bm25      Pct diff
            SpanNear        4.29        0.52        4.14        0.49  -24% -   22%
              Phrase        3.97        0.25        3.89        0.25  -13% -   11%
                Term       82.18        4.78       81.00        2.56   -9% -    7%
      TermBGroup1M1P       83.30        2.41       82.12        2.20   -6% -    4%
        SloppyPhrase        8.03        0.31        7.93        0.43  -10% -    8%
         AndHighHigh       19.38        0.59       19.16        0.71   -7% -    5%
            PKLookup      175.49        4.33      173.67        4.20   -5% -    3%
          AndHighMed       40.99        1.12       40.71        1.07   -5% -    4%
         TermGroup1M       25.69        0.39       25.69        0.44   -3% -    3%
              Fuzzy2       42.62        1.83       42.65        1.80   -8% -    8%
              Fuzzy1       91.74        3.48       91.86        3.44   -7% -    7%
             Respell       73.96        3.30       74.18        3.29   -8% -    9%
            Wildcard       56.33        0.97       56.60        1.08   -3% -    4%
             Prefix3       33.36        0.83       33.59        0.97   -4% -    6%
        TermBGroup1M       55.58        1.03       56.17        0.88   -2% -    4%
              IntNRQ       13.38        0.74       13.58        0.94  -10% -   14%
           OrHighMed       11.71        1.18       11.94        0.97  -14% -   22%
          OrHighHigh        8.91        0.74        9.13        0.63  -11% -   19%
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    <comment id="13090872" author="david_nemeskey" created="Thu, 25 Aug 2011 09:50:29 +0100"  >&lt;p&gt;Hi Robert,&lt;/p&gt;

&lt;p&gt;I would very much like to run this test on the other sims as well. How do I do &lt;br/&gt;
that?&lt;/p&gt;

&lt;p&gt;David&lt;/p&gt;
</comment>
                    <comment id="13090891" author="rcmuir" created="Thu, 25 Aug 2011 10:45:38 +0100"  >&lt;p&gt;There is a project here that lets you benchmark using wikipedia: &lt;a href=&quot;http://code.google.com/a/apache-extras.org/p/luceneutil/&quot; class=&quot;external-link&quot;&gt;http://code.google.com/a/apache-extras.org/p/luceneutil/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You need this patch to benchmark Similarities: &lt;a href=&quot;http://code.google.com/a/apache-extras.org/p/luceneutil/issues/detail?id=6&quot; class=&quot;external-link&quot;&gt;http://code.google.com/a/apache-extras.org/p/luceneutil/issues/detail?id=6&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(More information on how to get started here: &lt;a href=&quot;http://code.google.com/a/apache-extras.org/p/luceneutil/source/browse/README.txt&quot; class=&quot;external-link&quot;&gt;http://code.google.com/a/apache-extras.org/p/luceneutil/source/browse/README.txt&lt;/a&gt;)&lt;/p&gt;</comment>
                    <comment id="13098607" author="rcmuir" created="Wed, 7 Sep 2011 06:40:56 +0100"  >&lt;p&gt;patch removing all nocommits&lt;/p&gt;

&lt;p&gt;for the fake IDF/phrase issue, i thought it best not to &quot;fake&quot; statistics to SimilarityBase, since the whole point is to make it simpler for implementing/testing ranking models.&lt;/p&gt;

&lt;p&gt;instead it sums scores across terms (kinda like boolean query)&lt;/p&gt;

&lt;p&gt;for DFR P and D, I don&apos;t think there are really any great practical ways out of the fundamental problem. I added notes to both of these.&lt;/p&gt;

&lt;p&gt;i think the workaround for dirichlet is fine, i looked around and found another implementation of this smoothing by hiemstra and it had the same workaround (&lt;a href=&quot;http://mirex.sourceforge.net&quot; class=&quot;external-link&quot;&gt;http://mirex.sourceforge.net&lt;/a&gt;&lt;br/&gt;
 / trec.nist.gov/pubs/trec19/papers/univ.twente.web.rev.pdf)&lt;/p&gt;

&lt;p&gt;all the other similarities seem to work fine being randomly swapped into lucene&apos;s tests.&lt;/p&gt;</comment>
                    <comment id="13101318" author="rcmuir" created="Fri, 9 Sep 2011 17:42:44 +0100"  >&lt;p&gt;attached is a diff (using dev-tools/scripts/diff-sources.py) between the branch and trunk.&lt;/p&gt;

&lt;p&gt;I think this is ready.&lt;/p&gt;</comment>
                    <comment id="13101320" author="rcmuir" created="Fri, 9 Sep 2011 17:45:28 +0100"  >&lt;p&gt;oops, i had some stuff in solr/example/work that caused a lot of noise in the patch.&lt;/p&gt;</comment>
                    <comment id="13102291" author="rcmuir" created="Sun, 11 Sep 2011 16:49:51 +0100"  >&lt;p&gt;Committed to trunk: Thank you David for the fantastic work here!&lt;/p&gt;</comment>
                    <comment id="13102371" author="mikemccand" created="Mon, 12 Sep 2011 00:03:00 +0100"  >&lt;p&gt;Thanks David and Robert!&lt;/p&gt;

&lt;p&gt;What an incredible step forward: now you can easily try out all sorts of pre-existing scoring models, or make your own.  Yay &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="13113958" author="hadasra" created="Sat, 24 Sep 2011 13:33:53 +0100"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;First of all, I would like to thank you for the great contribution you made by adding the state of the art ranking methods to lucene. I was waiting for these  features for a long time, since they enable an IR researcher like me to use lucene, which is a powerful tool, for research purposes.&lt;/p&gt;

&lt;p&gt;I downloaded the last version of lucene trunk and played a little with the models you implemented. There is question I have and I would really appreciate your answer (my apology in advance - I&apos;m new to lucene so maybe this question is trivial for you):&lt;/p&gt;

&lt;p&gt;I saw that you didn&apos;t change the default implementation of lucene for coding the document length which is used for ranking in language models (one byte for coding the document length together with boosting). Why did you decide that? Is it possible to save the &quot;real&quot; document length coded in some other way (maybe with the new flexible index)? Is there any example for such an implementation? It is just that I&apos;m concerned with the effect of using an inaccurate document length on results quality. Did you check this issue?&lt;/p&gt;

&lt;p&gt;In addition - do you know about intentions to implement some more advanced ranking models (such as relevance models, mrf) in the near future?&lt;/p&gt;

&lt;p&gt;Thanks in advance,&lt;br/&gt;
Hadas&lt;/p&gt;</comment>
                    <comment id="13113977" author="rcmuir" created="Sat, 24 Sep 2011 14:37:07 +0100"  >&lt;blockquote&gt;
&lt;p&gt;I saw that you didn&apos;t change the default implementation of lucene for coding the document length which is used for ranking in language models (one byte for coding the document length together with boosting). Why did you decide that?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;So that you can switch between ranking models without re-indexing.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;It is just that I&apos;m concerned with the effect of using an inaccurate document length on results quality. Did you check this issue?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I ran experiments on this a long time ago, the changes were not statistically significant.&lt;br/&gt;
But, there is an issue open to still switch norms to docvalues fields, for other reasons: &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-3221&quot; title=&quot;improve docvalues integration with scoring&quot;&gt;LUCENE-3221&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;In addition - do you know about intentions to implement some more advanced ranking models (such as relevance models, mrf) in the near future?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No, there won&apos;t be any additional work on this issue, GSOC is over. &lt;/p&gt;



</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12441459">LUCENE-2091</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12461758">LUCENE-2392</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12473256" name="implementation_plan.pdf" size="49902" author="david_nemeskey" created="Thu, 10 Mar 2011 10:51:29 +0000" />
                    <attachment id="12474975" name="LUCENE-2959_mockdfr.patch" size="8419" author="rcmuir" created="Wed, 30 Mar 2011 16:24:29 +0100" />
                    <attachment id="12493275" name="LUCENE-2959_nocommits.patch" size="22780" author="rcmuir" created="Wed, 7 Sep 2011 06:40:56 +0100" />
                    <attachment id="12493814" name="LUCENE-2959.patch" size="445889" author="rcmuir" created="Fri, 9 Sep 2011 17:45:28 +0100" />
                    <attachment id="12493806" name="LUCENE-2959.patch" size="552168" author="rcmuir" created="Fri, 9 Sep 2011 17:42:44 +0100" />
                    <attachment id="12473255" name="proposal.pdf" size="86654" author="david_nemeskey" created="Thu, 10 Mar 2011 10:50:58 +0000" />
                </attachments>
            <subtasks>
            <subtask id="12509307">LUCENE-3173</subtask>
            <subtask id="12509312">LUCENE-3174</subtask>
            <subtask id="12510940">LUCENE-3220</subtask>
            <subtask id="12516879">LUCENE-3357</subtask>
            <subtask id="12519499">LUCENE-3385</subtask>
            <subtask id="12519502">LUCENE-3386</subtask>
            <subtask id="12519521">LUCENE-3387</subtask>
            <subtask id="12519670">LUCENE-3391</subtask>
            <subtask id="12519701">LUCENE-3393</subtask>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>6.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 10 Mar 2011 21:41:25 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3940</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24733</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>