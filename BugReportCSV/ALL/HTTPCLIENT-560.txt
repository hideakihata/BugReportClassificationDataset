entities and connection handling incomplete
1. entities can not be explicitly disconnected from the underlying stream 2. entities do not tell whether they have an underlying stream patch follows cheers   RolandCreated an attachment id 17587 patch take 1 the patch includes - two new methods in HttpEntity - two new classes AbstractHttpEntity and HttpEntityWrapper - updated entity classes in org.apache.http.entity - updated entity classes in org.apache.http.contrib.compress - updated JavaDocs primarily in HttpEntity the patch is missing - test cases for the two new classes - item 3 from the mail linked in the bug report When reading and writing JavaDocs in HttpEntity I noticed some things that need clarification. I ll start a discussion in the developer mailing list about this. cheers   Roland Roland The patch does not apply cleanly against the SVN trunk for me. There are multiple problems with it which are too many and too difficult to correct manually. Please make sure you have got the latest SVN snapshot by always running svn up prior to running svn diff . Another thing the new classes did not make it into the patch. Please add them to version control by running svn add pull file name prior to running svn diff OlegCreated an attachment id 17589 patch take 2 Hi Oleg this one has the new files. But svn up just tells me At revision 374885. I ve run svn co before I started hacking today to make sure I m working against the current code. cheers   Roland That is weird. The patch applies cleanly neither using Eclipse nor patch util. I will have to fix all these conflicts manually. Meanwhile can you try to apply this patch against a completely fresh snapshot of the SVN trunk and see if that works for you What is your patch version oleg dld810 src apache.org jakarta httpcomponents http-core patch -p2 2k6-02-04-entity-patch-2.txt patching file src contrib org apache http contrib compress GzipCompressingEntity.java Hunk 1 FAILED at 36. 1 out of 3 hunks FAILED saving rejects to file src contrib org apache http contrib compress GzipCompressingEntity.java.rejpatching file src contrib org apache http contrib compress GzipDecompressingEntity.java Hunk 1 FAILED at 36. 1 out of 1 hunk FAILED saving rejects to file src contrib org apache http contrib compress GzipDecompressingEntity.java.rej patching file src java org apache http HttpEntity.java Hunk 1 succeeded at 34 with fuzz 1. patching file src java org apache http entity BufferedHttpEntity.java Hunk 1 FAILED at 39. 1 out of 3 hunks FAILED saving rejects to file src java org apache http entity BufferedHttpEntity.java.rej patching file src java org apache http entity ByteArrayEntity.java Hunk 1 FAILED at 36. 1 out of 3 hunks FAILED saving rejects to file src java org apache http entity ByteArrayEntity.java.rej patching file src java org apache http entity AbstractHttpEntity.java patching file src java org apache http entity StringEntity.java Hunk 1 FAILED at 39. 1 out of 4 hunks FAILED saving rejects to file src java org apache http entity StringEntity.java.rej patching file src java org apache http entity InputStreamEntity.java Hunk 1 FAILED at 35. 1 out of 3 hunks FAILED saving rejects to file src java org apache http entity InputStreamEntity.java.rej patching file src java org apache http entity FileEntity.java Hunk 1 FAILED at 37. 1 out of 3 hunks FAILED saving rejects to file src java org apache http entity FileEntity.java.rej patching file src java org apache http entity HttpEntityWrapper.java patching file src java org apache http entity BasicHttpEntity.java oleg dld810 src apache.org jakarta httpcomponents http-core patch version patch 2.5.9 Copyright C 1988 Larry Wall Copyright C 2003 Free Software Foundation Inc. This program comes with NO WARRANTY to the extent permitted by law. You may redistribute copies of this program under the terms of the GNU General Public License. For more information about these matters see the file named COPYING. written by Larry Wall and Paul EggertMy bad. I think the relevant one is diff. What s your version oleg dld810 src apache.org jakarta httpcomponents http-core diff version diff GNU diffutils 2.8.1 Copyright C 2002 Free Software Foundation Inc. This program comes with NO WARRANTY to the extent permitted by law. You may redistribute copies of this program under the terms of the GNU General Public License. For more information about these matters see the file named COPYING. Written by Paul Eggert Mike Haertel David Hayes Richard Stallman and Len Tower.  Hi Oleg I ve created the patch using svn diff . Heaven knows why they don t have a svn patch to apply their diffs. The version of subversion is svn version 1.2.3 r15833 The version of the diff in my path is diff GNU diffutils 2.8.7 I ll see what patch makes out of it patch 2.5.9 cheers   Roland Hi Oleg I get the same errors as you against a clean checkout. cheers   Roland This is going to be quite a nuisance if we are not able to reliably exchange patches. I am in the process of fixing the conflicts manually and will apply the patch as soon as I am done OlegPatch checked in. Many thanks Roland I still would like to see if the new functionality can be made optional through the use of a marker interface. I ll sleep over it and see what I can come up with Oleg In reply to comment 9 I still would like to see if the new functionality can be made optional through the use of a marker interface. I ll sleep over it and see what I can come up with I looked at it. Even though having this functionality in a marker interface would be cleaner conceptually it does make wrapping entities tricky A wrapper cannot implement an interface optionally depending on what kind of entity is wraps . Case closed. Oleg
