Document the problem with MS impl of digest authentication with older JREs and stale connection check
It seems like digest authentication when used with a username of the format domain username fails in httpclient-3.0-rc2. I did confirm that digest authentication does work by connecting to a local Apache HTTP 2.0 server using just a username and password no domain username . However it does not support the MD5-sess algorithm and the server I am getting the failure from is using MD5-sess. It may turn out the username is not causing the problem but one thing is consistent I can connect to the site in the logs below using httpclient-2.0.2. It fails when I use identical Java code with the addition of AuthScope when using httpclient-3.0-rc2. I will also attach Java code that reproduces the problem. The following are wire and debug logs from httpclient-2.0.2 and httpclient-3.0-rc2 respectively. The first one connects and gets an HTTP 200 response. The second one using 3.0-rc2 fails with an HTTP 401 . LOGS commons-httpclient-2.0.2 works 2005 05 13 11 05 15 185 EDT DEBUG HttpClient - Java version 1.3.1 2005 05 13 11 05 15 185 EDT DEBUG HttpClient - Java vendor IBM Corporation 2005 05 13 11 05 15 185 EDT DEBUG HttpClient - Java class path 2005 05 13 11 05 15 205 EDT DEBUG HttpClient - Operating system name Windows XP 2005 05 13 11 05 15 205 EDT DEBUG HttpClient - Operating system architecture x86 2005 05 13 11 05 15 205 EDT DEBUG HttpClient - Operating system version 5.1 2005 05 13 11 05 15 205 EDT DEBUG HttpClient - SUN 1.2 SUN DSA key parameter generation DSA signing SHA-1 MD5 digests SecureRandom X.509 certificates JKS keystore 2005 05 13 11 05 15 205 EDT DEBUG HttpClient - SunJCE 1.22 SunJCE Provider implements DES Triple DES Blowfish PBE Diffie-Hellman HMAC-MD5 HMAC-SHA1 2005 05 13 11 05 15 205 EDT DEBUG HttpClient - SunJSSE 1.0303 Sun JSSE provider implements RSA Signatures PKCS12 SunX509 key trust factories SSLv3 TLSv1 2005 05 13 11 05 20 893 EDT DEBUG HttpConnection - HttpConnection.setSoTimeout 0 2005 05 13 11 05 20 893 EDT DEBUG HttpMethodBase - Execute loop try 1 2005 05 13 11 05 20 913 EDT DEBUG header - GET CustomerData-30 CustomerDataService.asmx HTTP 1.1 r n 2005 05 13 11 05 20 913 EDT DEBUG HttpMethodBase - Adding Host request header 2005 05 13 11 05 20 913 EDT DEBUG header - User-Agent Jakarta Commons-HttpClient 2.0.2 r n 2005 05 13 11 05 20 913 EDT DEBUG header - Host mappoint-css.partners.extranet.microsoft.com r n 2005 05 13 11 05 21 173 EDT DEBUG header - r n 2005 05 13 11 05 21 273 EDT DEBUG header - HTTP 1.1 401 Unauthorized r n 2005 05 13 11 05 21 273 EDT DEBUG header - Content-Length 1656 r n 2005 05 13 11 05 21 283 EDT DEBUG header - Content-Type text html r n 2005 05 13 11 05 21 283 EDT DEBUG header - Server Microsoft-IIS 6.0 r n 2005 05 13 11 05 21 283 EDT DEBUG header - WWW-Authenticate Digest qop auth algorithm MD5-sess nonce b2a83a38cd57c501af3ad2c91f189512060524424ffc2b818c9920db15cd247a9d47cf5a789d63c6 opaque 1704373a505e74c4ec692978e5c1a539 charset utf-8 realm Digest r n 2005 05 13 11 05 21 283 EDT DEBUG header - X-Powered-By ASP.NET r n 2005 05 13 11 05 21 283 EDT DEBUG header - Date Fri 13 May 2005 15 05 37 GMT r n 2005 05 13 11 05 21 283 EDT DEBUG HttpMethodBase - Authorization required 2005 05 13 11 05 21 283 EDT DEBUG HttpAuthenticator - Authenticating with the Digest authentication realm at mappoint-css.partners.extranet.microsoft.com 2005 05 13 11 05 21 283 EDT DEBUG DigestScheme - Using qop method auth 2005 05 13 11 05 21 283 EDT DEBUG HttpMethodBase - HttpMethodBase.execute Server demanded authentication credentials will try again. 2005 05 13 11 05 21 293 EDT DEBUG HttpMethodBase - Resorting to protocol version default close connection policy 2005 05 13 11 05 21 293 EDT DEBUG HttpMethodBase - Should NOT close connection using HTTP 1.1. 2005 05 13 11 05 21 293 EDT DEBUG HttpMethodBase - Execute loop try 2 2005 05 13 11 05 21 293 EDT DEBUG header - GET CustomerData-30 CustomerDataService.asmx HTTP 1.1 r n 2005 05 13 11 05 21 293 EDT DEBUG HttpMethodBase - Request to add Host header ignored header already added 2005 05 13 11 05 21 293 EDT DEBUG header - User-Agent Jakarta Commons-HttpClient 2.0.2 r n 2005 05 13 11 05 21 293 EDT DEBUG header - Host mappoint-css.partners.extranet.microsoft.com r n 2005 05 13 11 05 21 293 EDT DEBUG header - Authorization Digest username domain user realm Digest nonce b2a83a38cd57c501af3ad2c91f189512060524424ffc2b818c9920db15cd247a9d47cf5a789d63c6 uri CustomerData-30 CustomerDataService.asmx qop auth algorithm MD5-sess nc 00000001 cnonce 393a8abf65cd20f85ffdf46a9273b28b response 854bf54261112caf2e86652276cb2ce6 opaque 1704373a505e74c4ec692978e5c1a539 r n 2005 05 13 11 05 21 293 EDT DEBUG header - r n 2005 05 13 11 05 21 994 EDT DEBUG header - HTTP 1.1 200 OK r n HTTP result 200 commons-httpclient-3.0-rc2 does not work 2005 05 13 11 16 54 881 EDT DEBUG DefaultHttpParams - -Set parameter http.useragent Jakarta Commons-HttpClient 3.0-rc2 2005 05 13 11 16 54 881 EDT DEBUG DefaultHttpParams - -Set parameter http.protocol.version HTTP 1.1 2005 05 13 11 16 54 881 EDT DEBUG DefaultHttpParams - -Set parameter http.connection-manager.class class org.apache.commons.httpclient.SimpleHttpConnectionManager 2005 05 13 11 16 54 891 EDT DEBUG DefaultHttpParams - -Set parameter http.protocol.cookie-policy rfc2109 2005 05 13 11 16 54 891 EDT DEBUG DefaultHttpParams - -Set parameter http.protocol.element-charset US-ASCII 2005 05 13 11 16 54 891 EDT DEBUG DefaultHttpParams - -Set parameter http.protocol.content-charset ISO-8859-1 2005 05 13 11 16 54 891 EDT DEBUG DefaultHttpParams - -Set parameter http.method.retry-handler org.apache.commons.httpclient.DefaultHttpMethodRetryHandler 5048d78c 2005 05 13 11 16 54 891 EDT DEBUG DefaultHttpParams - -Set parameter http.dateparser.patterns EEE dd MMM yyyy HH mm ss zzz EEEE dd-MMM-yy HH mm ss zzz EEE MMM d HH mm ss yyyy EEE dd-MMM-yyyy HH mm ss z EEE dd-MMM-yyyy HH-mm-ss z EEE dd MMM yy HH mm ss z EEE dd-MMM-yyyy HH mm ss z EEE dd MMM yyyy HH mm ss z EEE dd-MMM-yyyy HH-mm-ss z EEE dd-MMM-yy HH mm ss z EEE dd MMM yy HH mm ss z EEE dd-MMM-yy HH mm ss z EEE dd-MMM-yyyy HH mm ss z EEE dd-MM-yyyy HH mm ss z 2005 05 13 11 16 54 911 EDT DEBUG HttpClient - -Java version 1.3.1 2005 05 13 11 16 54 911 EDT DEBUG HttpClient - -Java vendor IBM Corporation 2005 05 13 11 16 54 911 EDT DEBUG HttpClient - -Java class path 2005 05 13 11 16 54 941 EDT DEBUG HttpClient - -Operating system name Windows XP 2005 05 13 11 16 54 941 EDT DEBUG HttpClient - -Operating system architecture x86 2005 05 13 11 16 54 941 EDT DEBUG HttpClient - -Operating system version 5.1 2005 05 13 11 16 54 941 EDT DEBUG HttpClient - -SUN 1.2 SUN DSA key parameter generation DSA signing SHA-1 MD5 digests SecureRandom X.509 certificates JKS keystore 2005 05 13 11 16 54 951 EDT DEBUG HttpClient - -SunJCE 1.22 SunJCE Provider implements DES Triple DES Blowfish PBE Diffie-Hellman HMAC-MD5 HMAC-SHA1 2005 05 13 11 16 54 951 EDT DEBUG HttpClient - -SunJSSE 1.0303 Sun JSSE provider implements RSA Signatures PKCS12 SunX509 key trust factories SSLv3 TLSv1 2005 05 13 11 16 54 961 EDT DEBUG HttpConnection - -Open connection to mappoint-css.partners.extranet.microsoft.com 443 2005 05 13 11 17 00 629 EDT DEBUG header - - GET CustomerData-30 CustomerDataService.asmx HTTP 1.1 r n 2005 05 13 11 17 00 629 EDT DEBUG HttpMethodBase - -Adding Host request header 2005 05 13 11 17 00 639 EDT DEBUG header - - User-Agent Jakarta Commons-HttpClient 3.0-rc2 r n 2005 05 13 11 17 00 639 EDT DEBUG header - - Host mappoint-css.partners.extranet.microsoft.com r n 2005 05 13 11 17 00 639 EDT DEBUG header - - r n 2005 05 13 11 17 00 989 EDT DEBUG header - - HTTP 1.1 401 Unauthorized r n 2005 05 13 11 17 00 999 EDT DEBUG header - - Content-Length 1656 r n 2005 05 13 11 17 00 999 EDT DEBUG header - - Content-Type text html r n 2005 05 13 11 17 00 999 EDT DEBUG header - - Server Microsoft-IIS 6.0 r n 2005 05 13 11 17 00 999 EDT DEBUG header - - WWW-Authenticate Digest qop auth algorithm MD5-sess nonce c66759cace57c5016cf5645c6dee5b649ed29067f652939d6aaf7239310bb333eeb0153783ae445f opaque e7e259c137b65766c971d6cfc4115789 charset utf-8 realm Digest r n 2005 05 13 11 17 00 999 EDT DEBUG header - - X-Powered-By ASP.NET r n 2005 05 13 11 17 00 999 EDT DEBUG header - - Date Fri 13 May 2005 15 16 51 GMT r n 2005 05 13 11 17 00 999 EDT DEBUG HttpMethodDirector - -Authorization required 2005 05 13 11 17 01 009 EDT DEBUG AuthChallengeProcessor - -Supported authentication schemes in the order of preference ntlm digest basic 2005 05 13 11 17 01 009 EDT DEBUG AuthChallengeProcessor - -Challenge for ntlm authentication scheme not available 2005 05 13 11 17 01 009 EDT INFO AuthChallengeProcessor - -digest authentication scheme selected 2005 05 13 11 17 01 009 EDT DEBUG AuthChallengeProcessor - -Using authentication scheme digest 2005 05 13 11 17 01 009 EDT DEBUG AuthChallengeProcessor - -Authorization challenge processed 2005 05 13 11 17 01 009 EDT DEBUG HttpMethodDirector - -Authentication scope DIGEST Digest mappoint-css.partners.extranet.microsoft.com 443 2005 05 13 11 17 01 009 EDT DEBUG HttpMethodDirector - -Retry authentication 2005 05 13 11 17 01 019 EDT DEBUG HttpMethodBase - -Resorting to protocol version default close connection policy 2005 05 13 11 17 01 019 EDT DEBUG HttpMethodBase - -Should NOT close connection using HTTP 1.1 2005 05 13 11 17 01 019 EDT DEBUG HttpConnection - -Connection is locked. Call to releaseConnection ignored. 2005 05 13 11 17 01 019 EDT DEBUG HttpMethodDirector - -Authenticating with DIGEST Digest mappoint-css.partners.extranet.microsoft.com 443 2005 05 13 11 17 01 019 EDT DEBUG HttpMethodParams - -Credential charset not configured using HTTP element charset 2005 05 13 11 17 01 019 EDT DEBUG DigestScheme - -Using qop method auth 2005 05 13 11 17 01 019 EDT DEBUG HttpConnection - -Connection is stale closing... 2005 05 13 11 17 01 019 EDT DEBUG HttpConnection - -Open connection to mappoint-css.partners.extranet.microsoft.com 443 2005 05 13 11 17 01 110 EDT DEBUG header - - GET CustomerData-30 CustomerDataService.asmx HTTP 1.1 r n 2005 05 13 11 17 01 110 EDT DEBUG HttpMethodBase - -Adding Host request header 2005 05 13 11 17 01 110 EDT DEBUG header - - User-Agent Jakarta Commons-HttpClient 3.0-rc2 r n 2005 05 13 11 17 01 110 EDT DEBUG header - - Authorization Digest username domain user realm Digest nonce c66759cace57c5016cf5645c6dee5b649ed29067f652939d6aaf7239310bb333eeb0153783ae445f uri CustomerData-30 CustomerDataService.asmx response 9cab4fcdb2d09f57523aec80d7b51e95 qop auth nc 00000001 cnonce b27507ee79c880b2bb565d363598ce07 algorithm MD5-sess opaque e7e259c137b65766c971d6cfc4115789 r n 2005 05 13 11 17 01 120 EDT DEBUG header - - Host mappoint-css.partners.extranet.microsoft.com r n 2005 05 13 11 17 01 120 EDT DEBUG header - - r n 2005 05 13 11 17 01 540 EDT DEBUG header - - HTTP 1.1 401 Unauthorized r n 2005 05 13 11 17 01 540 EDT DEBUG header - - Content-Length 1539 r n 2005 05 13 11 17 01 540 EDT DEBUG header - - Content-Type text html r n 2005 05 13 11 17 01 550 EDT DEBUG header - - Server Microsoft-IIS 6.0 r n 2005 05 13 11 17 01 550 EDT DEBUG header - - WWW-Authenticate Digest qop auth algorithm MD5-sess nonce 3296b0dace57c5012fe314f8c6f8cafd10abc7a61c09484b2be5c7ef19ecb3c080da1f82c3f5a532 opaque 87578a7f0871280654aed868cb9497fb charset utf-8 realm Digest r n 2005 05 13 11 17 01 550 EDT DEBUG header - - X-Powered-By ASP.NET r n 2005 05 13 11 17 01 550 EDT DEBUG header - - Date Fri 13 May 2005 15 17 19 GMT r n 2005 05 13 11 17 01 550 EDT DEBUG HttpMethodDirector - -Authorization required 2005 05 13 11 17 01 550 EDT DEBUG AuthChallengeProcessor - -Using authentication scheme digest 2005 05 13 11 17 01 550 EDT DEBUG AuthChallengeProcessor - -Authorization challenge processed 2005 05 13 11 17 01 550 EDT DEBUG HttpMethodDirector - -Authentication scope DIGEST Digest mappoint-css.partners.extranet.microsoft.com 443 2005 05 13 11 17 01 550 EDT DEBUG HttpMethodDirector - -Credentials required HTTP result 401 2005 05 13 11 17 01 550 EDT DEBUG HttpMethodDirector - -Credentials provider not available 2005 05 13 11 17 01 580 EDT INFO HttpMethodDirector - -Failure authenticating with DIGEST Digest mappoint-css.partners.extranet.microsoft.com 443 2005 05 13 11 17 01 580 EDT DEBUG HttpMethodBase - -Buffering response body 2005 05 13 11 17 01 580 EDT DEBUG HttpMethodBase - -Resorting to protocol version default close connection policy 2005 05 13 11 17 01 580 EDT DEBUG HttpMethodBase - -Should NOT close connection using HTTP 1.1 2005 05 13 11 17 01 580 EDT DEBUG HttpConnection - -Releasing connection back to connection manager.Created an attachment id 15022 Reproduces the error. I think this problem has nothing to do with the user name. I was able to establish that HttpClient 3.0 produced a different auth string compared to that produced by HttpClient 2.0 in response to the same auth challenge Credentials creds new UsernamePasswordCredentials domain username password DigestScheme authscheme new DigestScheme Digest qop auth algorithm MD5-sess nonce b2a83a38cd57c501af3ad2c91f189512060524424ffc2b818c9920db15cd247a9d47cf5a789d63c6 opaque 1704373a505e74c4ec692978e5c1a539 charset utf-8 realm Digest System.out.println authscheme.authenticate creds GET HttpClient 2.0 output Digest username domain username realm Digest nonce b2a83a38cd57c501af3ad2c91f189512060524424ffc2b818c9920db15cd247a9d47cf5a789d63c6 uri qop auth algorithm MD5-sess nc 00000001 cnonce 3e7cee60022e0f9c6d23cd9dea46a033 response 3c997fba9c2e77e1c37fadd352006a46 opaque 1704373a505e74c4ec692978e5c1a539 HttpClient 3.0 output Digest username domain username realm Digest nonce b2a83a38cd57c501af3ad2c91f189512060524424ffc2b818c9920db15cd247a9d47cf5a789d63c6 uri response 038567efed48e01d0f08d27526b6ebda algorithm MD5-sess opaque 1704373a505e74c4ec692978e5c1a539 Obviously the responses are different and this may well be the cause of the problem. I remember the DigestScheme code was revised for better compliance with RFC 2617. Theoretically HttpClient 3.0 should produce more compliant auth responses. So I am not entirely sure whether this problem is HttpClient s fault or that of MS IIS. I do encourage you to experiment with HttpClient s code if you want a quick resolution to this issue since you are the only person who can reliably reproduce the problem. In my turn I ll try to review HttpClient s handling of MD5-sess algorithm for compliance with RFC 2617. I make no promises as to how quickly I can do that though. OlegJeff I was wrong in my initial assumption because my test case was flawed. The invalid auth response generated by HttpClient 3.0 was due to a deprecated constructor I used in my test cases. So this does not look good. I may need a set of valid credentials for the site in order to proceed. OlegI did some further research. I am certain that given the same auth challenge and the same cnonce value both HttpClient versions produce the same credentials hash response attribute . The only obvious difference is slightly different arrangement of attributes in the auth response. I do not think this should matter but currently this is the only plausible theory that can explain the failure HttpClient 2.0 Digest   username domain username   realm Digest   nonce b2a83a38cd57c501af3ad2c91f189512060524424ffc2b818c9920db15cd247a9d47cf5a789d63c6   uri   qop auth   algorithm MD5-sess   nc 00000001   cnonce a9b7ba70783b617e9998dc4dd82eb3c5   response 22c567093b3689e1edf4184fad8218d3   opaque 1704373a505e74c4ec692978e5c1a539 HttpClient 3.0 Digest   username domain username   realm Digest   nonce b2a83a38cd57c501af3ad2c91f189512060524424ffc2b818c9920db15cd247a9d47cf5a789d63c6   uri   response 22c567093b3689e1edf4184fad8218d3   qop auth   nc 00000001   cnonce a9b7ba70783b617e9998dc4dd82eb3c5   algorithm MD5-sess   opaque 1704373a505e74c4ec692978e5c1a539 OlegCreated an attachment id 15029 Test patch Jeff could you please test your app with this patch and let me know the result Meanwhile I ll try to find an HTTP server that supports MD5-sess I could test against. Oleg In reply to comment 3 Oleg I think this may be the same problem in the HTTP Client 3.0 code. I overlooked this before but I checked the response strings in the logs I posted for both the 2.0.2 and 3.0 client and they do NOT match just like in your initial test case where different responses were generated. I tried the patch too just in case no luck though. I seem to remember when I was stepping through the code for the 3.0 client that the cnonce value which I believe is seeded with the system time is hashed into the final response value I do not know if the 2.0.2 code does this but it may be why the 3.0 code is producing a different response. Jeff I was wrong in my initial assumption because my test case was flawed. The invalid auth response generated by HttpClient 3.0 was due to a deprecated constructor I used in my test cases. So this does not look good. I may need a set of valid credentials for the site in order to proceed. Oleg In reply to comment 6 In reply to comment 3 Oleg I think this may be the same problem in the HTTP Client 3.0 code. I overlooked this before but I checked the response strings in the logs I posted for both the 2.0.2 and 3.0 client and they do NOT match just like in your initial test case where different responses were generated. I tried the patch too just in case no luck though. I seem to remember when I was stepping through the code for the 3.0 client that the cnonce value which I believe is seeded with the system time is hashed into the final response value I do not know if the 2.0.2 code does this but it may be why the 3.0 code is producing a different response. I am reasonably sure both versions produce identical response values given the same challenge and cnonce value. Sadly Apache Http server does not provide support for MD5-sess yet. So I can t test the code myself and have to rely on the wire log that you have sent. I am afraid I will not be able to do much without access to an Microsoft IIS server with Digest MD5-sess authentication on. Oleg In reply to comment 7 I found this on msdn.microsoft.com it will allow you to create a temporary evaluation account. It should allow you to access the URL in the test case I attached https mappoint-css.partners.extranet.microsoft.com MwsSignup Eval.aspx I am reasonably sure both versions produce identical response values given the same challenge and cnonce value. Sadly Apache Http server does not provide support for MD5-sess yet. So I can t test the code myself and have to rely on the wire log that you have sent. I am afraid I will not be able to do much without access to an Microsoft IIS server with Digest MD5-sess authentication on. Oleg It turned out not to be a digest problem. I was reading the Known Limitations and Problems here http jakarta.apache.org commons httpclient 3.0 sslguide.html Since I am using JDK 1.3 I figured I might be having a problem with stale connection checking which it looks like is enabled by default in httpclient 2.0.2 and 3.0-rc2. I shut of stale connection checking and it started working in 3.0-rc2. At first this made no sense because stale connection checking is also enabled in 2.0.2 by default. What is different is the way each version implements isStale . The version 2.0.2 httpclient uses a PushbackInputStream while version 3.0-rc2 uses a BufferedInputStream. This may not be a problem in JDK 1.4 at all but for 1.3 it took a little time to figure out. I m still not entirely sure why this was causing the problem my guess is that because the client thought the connection was stale it re-opened a new one for which the nonce value the client had was no longer valid hence the 401 status code. In reply to comment 9 It turned out not to be a digest problem. I was reading the Known Limitations and Problems here http jakarta.apache.org commons httpclient 3.0 sslguide.html Since I am using JDK 1.3 I figured I might be having a problem with stale connection checking which it looks like is enabled by default in httpclient 2.0.2 and 3.0-rc2. I shut of stale connection checking and it started working in 3.0-rc2. At first this made no sense because stale connection checking is also enabled in 2.0.2 by default. What is different is the way each version implements isStale . The version 2.0.2 httpclient uses a PushbackInputStream while version 3.0-rc2 uses a BufferedInputStream. This may not be a problem in JDK 1.4 at all but for 1.3 it took a little time to figure out. I m still not entirely sure why this was causing the problem my guess is that because the client thought the connection was stale it re-opened a new one for which the nonce value the client had was no longer valid hence the 401 status code. This kind of explains it. I do not have good explanation as to why the stale connection check produces different results with different version of HttpClient but at least this perfectly explains why Microsoft IIS fails the authentication as IIS traditionally implements its security context based on the state of a persistent connection. Anyway out of this story I brought out three items I would like to follow upon 1 We need to document this case in the Known Limitations and Problems section of the SSL guide and provide a link in the authentication guide. I ll accept the bug as an enhancement request shortly 2 While working on this case I discovered the following document http www.microsoft.com technet prodtechnol windowsserver2003 library TechRef 717b450c-f4a0-4cc9-86f4-cc0633aae5f9.mspx As always Microsoft is true to its embrace and extend strategy towards open standards. Their implementation of Digest authentication while appears compliant with RFC 2616 and RFC 2617 in fact represents a superset of the standard with some additional Windows specific aspects. If you are interested in giving me a helping hand or even taking the lead we could implement a Windows specific version of DigestScheme 3 DigestScheme code review made me realize the currently HttpClient does not correctly handle escaped characters in HTTP elements. See an excerpt from Microsoft s How Digest Authentication Works document below quote RFC 2617-compliant Digest Authentication challenges and responses must also comply with RFC 2616 Hypertext Transfer Protocol HTTP 1.1 quoted string requirements. This requirement particularly affects the use of backslash and embedded double quotes. Both must be preceded escaped with a backslash. For example domain username according to RFC 2616 is read as domainusername. This reading is important because if an application sends information in this format rather than as domain username authentication fails. However because this is a known issue with domain username if authenticating with backslash encoding fails Digest SSP attempts to authenticate the response and assumes that the backslash is part of the string. This behavior can be turned off by setting the ServerCompat registry key. quote I ll file a bug report for this issue shortly Oleg in reply to comment 10 As always Microsoft is true to its embrace and extend strategy towards open standards. Their implementation of Digest authentication while appears compliant with RFC 2616 and RFC 2617 in fact represents a superset of the standard with some additional Windows specific aspects. If you are interested in giving me a helping hand or even taking the lead we could implement a Windows specific version of DigestScheme Sounds great I would really like to help lead that effort. In reply to comment 11 in reply to comment 10 ...  If you are interested in giving me a helping hand or even taking the lead we could implement a Windows specific version of DigestScheme Sounds great I would really like to help lead that effort. Cool. Please add yourself to the CC list of the HTTPCLIENT-460 or better yet subscribe to the httpclient-dev mailing list to monitor the status of the above bug report. I ll probably take the first stab at implementing the feature as most likely DigestScheme class will require some internal modifications to be reusable and pass it onto you for testing and further improvements. Oleg Created an attachment id 15407 Xdocs patch Folks please review and do correct my Ruslish as you see fit Oleglooks good to mePatch committed. HttpClient 3.0 site updated. Oleg
